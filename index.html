    <!DOCTYPE html>
    <html lang="en">
    <head>
    <meta charset="UTF-8" />
    <title>Professional Finder</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <style>
        :root {
        --bg: #f8fafc;
        --card: #ffffff;
        --border: #e5e7eb;
        --text: #020617;
        --muted: #64748b;
        --primary: #020617;
        --radius: 12px;
        }

        * {
        box-sizing: border-box;
        font-family: ui-sans-serif, system-ui;
        }

        body {
        margin: 0;
        background: var(--bg);
        display: flex;
        justify-content: center;
        padding: 40px 16px;
        }

        .container {
        width: 100%;
        max-width: 600px;
        background: var(--card);
        border: 1px solid var(--border);
        border-radius: var(--radius);
        padding: 24px;
        box-shadow: 0 10px 25px rgba(0,0,0,0.05);
        }

        h1 {
        text-align: center;
        margin-bottom: 6px;
        }

        .subtitle {
        text-align: center;
        font-size: 14px;
        color: var(--muted);
        margin-bottom: 20px;
        }

        label {
        font-size: 13px;
        color: var(--muted);
        margin-bottom: 6px;
        display: block;
        }

        input, select {
        width: 100%;
        padding: 10px 12px;
        border-radius: 8px;
        border: 1px solid var(--border);
        margin-bottom: 14px;
        font-size: 14px;
        }

        .filters {
        border: 1px dashed var(--border);
        border-radius: 10px;
        padding: 14px;
        margin-bottom: 16px;
        }

        .filter-row {
        display: flex;
        gap: 10px;
        align-items: center;
        margin-bottom: 10px;
        }

        button {
        width: 100%;
        padding: 11px;
        border-radius: 8px;
        border: none;
        background: var(--primary);
        color: white;
        cursor: pointer;
        margin-bottom: 8px;
        }

        button.secondary {
        background: #334155;
        }

        button:disabled {
        opacity: 0.6;
        cursor: not-allowed;
        }

        .results {
        margin-top: 20px;
        }

        .card-result {
        border: 1px solid var(--border);
        border-radius: 10px;
        padding: 14px;
        margin-bottom: 12px;
        }

        .name {
        font-size: 16px;
        font-weight: 600;
        }

        .info {
        font-size: 13px;
        color: var(--muted);
        margin-top: 4px;
        }

        .pagination {
        display: flex;
        gap: 10px;
        margin-top: 16px;
        }

        .loading, .empty {
        text-align: center;
        font-size: 14px;
        color: var(--muted);
        margin-top: 14px;
        }
    </style>
    </head>
    <body>

    <div class="container">
    <h1>Professional Finder</h1>
    <p class="subtitle">Search, paginate & export professionals</p>

    <label>Profession</label>
    <input id="profession" placeholder="Doctor, Lawyer, Engineer" />

    <label>Location</label>
    <input id="location" placeholder="Delhi, Mumbai" />

    <div class="filters">
        <label>Filters</label>

        <select id="minRating">
        <option value="0">Any Rating</option>
        <option value="3">3 ‚≠ê and above</option>
        <option value="4">4 ‚≠ê and above</option>
        <option value="4.5">4.5 ‚≠ê and above</option>
        </select>

        <div class="filter-row">
        <input type="checkbox" id="hasWebsite" />
        <label for="hasWebsite">Only with Website</label>
        </div>

        <div class="filter-row">
        <input type="checkbox" id="hasPhone" />
        <label for="hasPhone">Only with Phone</label>
        </div>
    </div>

    <button onclick="startSearch()">Search</button>
    <button class="secondary" onclick="exportToExcel()">Export to Excel</button>

    <div id="results" class="results"></div>

    <div class="pagination">
        <button id="prevBtn" class="secondary" onclick="prevPage()" disabled>Previous</button>
        <button id="nextBtn" class="secondary" onclick="nextPage()" disabled>Next</button>
    </div>
    </div>

    <script>
    const PAGE_SIZE = 10;
    let allResults = [];
    let currentPage = 1;
    let nextPageToken = null;

    const fieldMask = `
    places.displayName,
    places.rating,
    places.userRatingCount,
    places.websiteUri,
    places.nationalPhoneNumber,
    places.internationalPhoneNumber
    `.replace(/\s+/g, "");

    async function startSearch() {
    allResults = [];
    currentPage = 1;
    nextPageToken = null;
    document.getElementById("results").innerHTML = "";
    await fetchFromGoogle();
    renderPage();
    }

    async function fetchFromGoogle() {
    const profession = document.getElementById("profession").value.trim();
    const location = document.getElementById("location").value.trim();
    if (!profession || !location) return;

    const body = {
        textQuery: `${profession} in ${location}`,
        maxResultCount: 20
    };

    if (nextPageToken) {
        body.pageToken = nextPageToken;
        await new Promise(r => setTimeout(r, 2000));
    }

    const res = await fetch(
        "https://places.googleapis.com/v1/places:searchText",
        {
        method: "POST",
        headers: {
            "Content-Type": "application/json",
            "X-Goog-Api-Key": "AIzaSyASMvFbqaCYXmH18vVM78pkFR1PKVJBMX8",
            "X-Goog-FieldMask": fieldMask
        },
        body: JSON.stringify(body)
        }
    );

    const data = await res.json();
    nextPageToken = data.nextPageToken || null;

    const minRating = parseFloat(document.getElementById("minRating").value);
    const hasWebsite = document.getElementById("hasWebsite").checked;
    const hasPhone = document.getElementById("hasPhone").checked;

    (data.places || []).forEach(p => {
        if ((p.rating || 0) < minRating) return;
        if (hasWebsite && !p.websiteUri) return;
        if (hasPhone && !(p.nationalPhoneNumber || p.internationalPhoneNumber)) return;
        allResults.push(p);
    });

    document.getElementById("nextBtn").disabled =
        !nextPageToken && currentPage * PAGE_SIZE >= allResults.length;
    }

    function renderPage() {
    const resultsDiv = document.getElementById("results");
    resultsDiv.innerHTML = "";

    const start = (currentPage - 1) * PAGE_SIZE;
    const pageData = allResults.slice(start, start + PAGE_SIZE);

    pageData.forEach(place => {
        const card = document.createElement("div");
        card.className = "card-result";
        card.innerHTML = `
        <div class="name">${place.displayName?.text || "N/A"}</div>
        <div class="info">‚≠ê ${place.rating || "N/A"} (${place.userRatingCount || 0})</div>
        <div class="info">üìû ${place.nationalPhoneNumber || "Not available"}</div>
        <div class="info">üåê ${place.websiteUri || "Not available"}</div>
        `;
        resultsDiv.appendChild(card);
    });

    document.getElementById("prevBtn").disabled = currentPage === 1;
    }

    async function nextPage() {
    currentPage++;
    if (currentPage * PAGE_SIZE > allResults.length && nextPageToken) {
        await fetchFromGoogle();
    }
    renderPage();
    }

    function prevPage() {
    if (currentPage > 1) {
        currentPage--;
        renderPage();
    }
    }

    /* EXPORT TO EXCEL (CSV) */
    function exportToExcel() {
    if (allResults.length === 0) {
        alert("No data to export");
        return;
    }

    let csv = "Name,Rating,Reviews,Phone,Website\n";

    allResults.forEach(p => {
        csv += `"${p.displayName?.text || ""}",` +
            `"${p.rating || ""}",` +
            `"${p.userRatingCount || ""}",` +
            `"${p.nationalPhoneNumber || ""}",` +
            `"${p.websiteUri || ""}"\n`;
    });

    const blob = new Blob([csv], { type: "text/csv;charset=utf-8;" });
    const link = document.createElement("a");
    link.href = URL.createObjectURL(blob);
    link.download = "professionals.csv";
    link.click();
    }
    </script>

    </body>
    </html>
